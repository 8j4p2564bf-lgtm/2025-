<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家庭旅行規劃 & 記帳</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* 自定義深色 Vibe */
        body { background-color: #0f172a; color: #e2e8f0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .active-tab { background-color: #3b82f6; color: white; border-color: #3b82f6; }
        .weather-icon { font-size: 2rem; margin-right: 10px; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center pb-20">

    <header class="w-full max-w-md p-6 text-center">
        <h1 class="text-2xl font-bold tracking-wider text-blue-400">FAMILY TRIP 2025</h1>
        <p class="text-sm text-gray-400 mt-1">爸 · 媽 · 逸 · 松 的旅程</p>
    </header>

    <div class="w-full max-w-md flex overflow-x-auto space-x-2 p-4 scrollbar-hide" id="dayTabs">
        </div>

    <main class="w-full max-w-md p-4 space-y-6">
        
        <div class="glass rounded-2xl p-6 flex items-center justify-between shadow-lg">
            <div>
                <h2 class="text-lg font-semibold text-gray-200" id="weatherLoc">東京, 日本</h2>
                <p class="text-sm text-gray-400" id="weatherDesc">多雲時晴</p>
            </div>
            <div class="flex items-center text-yellow-400">
                <i class="fas fa-cloud-sun weather-icon"></i>
                <span class="text-3xl font-bold" id="weatherTemp">24°C</span>
            </div>
        </div>

        <div class="space-y-4" id="itineraryList">
            </div>

        <hr class="border-gray-700 my-8">

        <div class="glass rounded-2xl p-6 shadow-lg border-t-4 border-blue-500">
            <h3 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-wallet mr-2"></i> 快速記帳
            </h3>
            
            <div class="space-y-3">
                <input type="text" id="expenseItem" placeholder="消費項目 (例如: 拉麵)" class="w-full bg-gray-800 rounded-lg p-3 text-white border border-gray-700 focus:border-blue-500 outline-none transition">
                <input type="number" id="expenseAmount" placeholder="金額" class="w-full bg-gray-800 rounded-lg p-3 text-white border border-gray-700 focus:border-blue-500 outline-none transition">
                
                <p class="text-sm text-gray-400 mb-1">誰付錢？</p>
                <div class="grid grid-cols-4 gap-2" id="payerButtons">
                    <button onclick="selectPayer('爸')" class="payer-btn bg-gray-700 hover:bg-gray-600 py-2 rounded-lg transition text-sm">爸</button>
                    <button onclick="selectPayer('媽')" class="payer-btn bg-gray-700 hover:bg-gray-600 py-2 rounded-lg transition text-sm">媽</button>
                    <button onclick="selectPayer('逸')" class="payer-btn bg-gray-700 hover:bg-gray-600 py-2 rounded-lg transition text-sm">逸</button>
                    <button onclick="selectPayer('松')" class="payer-btn bg-gray-700 hover:bg-gray-600 py-2 rounded-lg transition text-sm">松</button>
                </div>
                <input type="hidden" id="selectedPayer">

                <button onclick="addExpense()" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg mt-4 transition shadow-lg active:scale-95">
                    新增紀錄
                </button>
            </div>

            <div class="mt-6">
                <h4 class="text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider">目前花費統計</h4>
                <ul id="expenseStats" class="space-y-2 text-sm">
                    </ul>
            </div>
            
            <div class="mt-4 pt-4 border-t border-gray-700">
                 <h4 class="text-xs font-bold text-gray-500 mb-2">近期紀錄</h4>
                 <ul id="recentExpenses" class="text-xs text-gray-400 space-y-1"></ul>
            </div>
        </div>
    </main>

    <script>
        // ================= 配置區 (把你的行程貼在下面) =================
        // 你可以在這裡修改每一天的行程和天氣預報
        const tripData = [
            {
                day: "Day 1",
                date: "10/10 (五)",
                weather: { temp: "22°C", desc: "多雲", icon: "fa-cloud" },
                events: [
                    { time: "10:00", title: "抵達機場", desc: "領取 WiFi 機，購買交通卡" },
                    { time: "12:30", title: "飯店 Check-in", desc: "放行李，稍作休息" },
                    { time: "14:00", title: "市區觀光", desc: "自由活動，或是去咖啡廳" },
                    { time: "19:00", title: "晚餐：燒肉", desc: "記得提前預約" }
                ]
            },
            {
                day: "Day 2",
                date: "10/11 (六)",
                weather: { temp: "25°C", desc: "晴天", icon: "fa-sun" },
                events: [
                    { time: "09:00", title: "出發去景點 A", desc: "搭乘地鐵紅線" },
                    { time: "12:00", title: "午餐", desc: "當地特色料理" },
                    { time: "15:00", title: "逛街購物", desc: "幫親戚買藥妝" }
                ]
            },
            {
                day: "Day 3",
                date: "10/12 (日)",
                weather: { temp: "19°C", desc: "有雨", icon: "fa-umbrella" },
                events: [
                    { time: "10:00", title: "博物館巡禮", desc: "室內行程避雨" },
                    { time: "18:00", title: "前往機場", desc: "搭乘機場快線" }
                ]
            }
        ];

        // 記帳資料 (預設為空)
        let expenses = JSON.parse(localStorage.getItem('tripExpenses')) || [];
        let currentDayIndex = 0;

        // ================= 邏輯區 =================

        function renderTabs() {
            const tabContainer = document.getElementById('dayTabs');
            tabContainer.innerHTML = '';
            tripData.forEach((day, index) => {
                const btn = document.createElement('button');
                btn.className = `px-5 py-2 rounded-full whitespace-nowrap text-sm font-medium transition border border-gray-700 ${index === currentDayIndex ? 'active-tab' : 'bg-gray-800 text-gray-400 hover:bg-gray-700'}`;
                btn.innerText = `${day.day} · ${day.date}`;
                btn.onclick = () => switchDay(index);
                tabContainer.appendChild(btn);
            });
        }

        function renderContent() {
            const data = tripData[currentDayIndex];
            
            // 更新天氣
            document.getElementById('weatherLoc').innerText = `第 ${currentDayIndex + 1} 天概況`;
            document.getElementById('weatherDesc').innerText = data.weather.desc;
            document.getElementById('weatherTemp').innerText = data.weather.temp;
            document.querySelector('.weather-icon').className = `fas ${data.weather.icon} weather-icon`;

            // 更新行程
            const list = document.getElementById('itineraryList');
            list.innerHTML = '';
            data.events.forEach(event => {
                const item = document.createElement('div');
                item.className = 'glass p-4 rounded-xl flex items-start space-x-4';
                item.innerHTML = `
                    <div class="text-blue-400 font-bold text-lg min-w-[60px]">${event.time}</div>
                    <div>
                        <h3 class="font-bold text-white text-lg">${event.title}</h3>
                        <p class="text-gray-400 text-sm mt-1">${event.desc}</p>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function switchDay(index) {
            currentDayIndex = index;
            renderTabs();
            renderContent();
        }

        // 記帳功能
        function selectPayer(name) {
            document.getElementById('selectedPayer').value = name;
            document.querySelectorAll('.payer-btn').forEach(btn => {
                if (btn.innerText === name) {
                    btn.classList.remove('bg-gray-700');
                    btn.classList.add('bg-blue-600', 'text-white');
                } else {
                    btn.classList.add('bg-gray-700');
                    btn.classList.remove('bg-blue-600', 'text-white');
                }
            });
        }

        function addExpense() {
            const item = document.getElementById('expenseItem').value;
            const amount = parseInt(document.getElementById('expenseAmount').value);
            const payer = document.getElementById('selectedPayer').value;

            if (!item || !amount || !payer) {
                alert("請填寫完整資訊並選擇付款人！");
                return;
            }

            expenses.push({ item, amount, payer, time: new Date().toLocaleString() });
            localStorage.setItem('tripExpenses', JSON.stringify(expenses));
            
            // 清空輸入
            document.getElementById('expenseItem').value = '';
            document.getElementById('expenseAmount').value = '';
            renderStats();
        }

        function renderStats() {
            const statsList = document.getElementById('expenseStats');
            const recentList = document.getElementById('recentExpenses');
            const totals = { '爸': 0, '媽': 0, '逸': 0, '松': 0 };
            let grandTotal = 0;

            recentList.innerHTML = '';
            // 顯示最近 3 筆
            expenses.slice().reverse().slice(0, 3).forEach(exp => {
                recentList.innerHTML += `<li class="flex justify-between"><span>${exp.payer} 付了 ${exp.item}</span> <span>$${exp.amount}</span></li>`;
            });

            expenses.forEach(exp => {
                if (totals[exp.payer] !== undefined) totals[exp.payer] += exp.amount;
                grandTotal += exp.amount;
            });

            statsList.innerHTML = `
                <li class="flex justify-between border-b border-gray-700 pb-1 mb-2"><span class="font-bold text-white">總花費</span> <span class="font-bold text-blue-400">$${grandTotal}</span></li>
                <li class="flex justify-between text-gray-300"><span>爸 先付</span> <span>$${totals['爸']}</span></li>
                <li class="flex justify-between text-gray-300"><span>媽 先付</span> <span>$${totals['媽']}</span></li>
                <li class="flex justify-between text-gray-300"><span>逸 先付</span> <span>$${totals['逸']}</span></li>
                <li class="flex justify-between text-gray-300"><span>松 先付</span> <span>$${totals['松']}</span></li>
            `;
        }

        // 初始化
        renderTabs();
        renderContent();
        renderStats();

    </script>
</body>
</html>
