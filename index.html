import { ChangeDetectionStrategy, Component, computed, signal } from '@angular/core';

// --- æ•¸æ“šæ¨¡å‹ (Data Model) ---
interface ScheduleItem {
 time: string;
 desc: string;
 icon: string;
 detail: string;
 isSpot?: boolean;
 spotName?: string;
}

interface DayItinerary {
 id: string;
 day: number;
 date: string;
 title: string;
 theme: string;
 schedule: ScheduleItem[];
}

// æ—…éŠæ ¸å¿ƒæ•¸æ“š
const ITINERARY_DATA: DayItinerary[] = [
   {
       id: 'day1', day: 1, date: "10/16 (å››)", title: "äº¬éƒ½åˆå°è±¡ï¼šåµå±±ï¼‹æœˆç‡ˆè·¯", theme: "è‡ªç„¶ãƒ»ç§»å‹•",
       schedule: [
           { time: "05:30", desc: "ç«¹åŒ— >> æ¡ƒæ©Ÿ 2 èˆªå»ˆ", icon: "ğŸš—", detail: "ç§äººæ¥é€" },
           { time: "09:00", desc: "æ¡ƒåœ’æ©Ÿå ´å‡ºç™¼", icon: "âœˆï¸", detail: "ä¸­è¯èˆªç©º CI0152" },
           { time: "13:00", desc: "æŠµé”é—œè¥¿æ©Ÿå ´", icon: "ğŸ›¬", detail: "é è¨ˆ 12:50 æŠµé”" },
           { time: "14:00", desc: "æ­ JR Haruka ç‰¹æ€¥ â†’ äº¬éƒ½è»Šç«™", icon: "ğŸš…", detail: "è»Šç¨‹ç´„ 70-80 åˆ†é˜ (ICOCA/Harukaå¥—ç¥¨)" },
           { time: "15:30", desc: "å…¥ä½ Hotel The Mâ€™s Kyoto", icon: "ğŸ¨", detail: "Check-in: 15:00 / é£¯åº—é›»è©±: +81-75-661-8000" },
           { time: "16:10", desc: "åµå±±æ¸¡æœˆæ©‹ã€ç«¹æ—å°å¾‘", icon: "ğŸƒ", detail: "å…è²»åƒè§€ï¼Œæ„Ÿå—äº¬éƒ½çš„è‡ªç„¶ç¾", isSpot: true },
           { time: "18:00", desc: "åƒåŠ åµå±±æœˆç‡ˆè·¯", icon: "ğŸŒ™", detail: "å­£ç¯€æ€§é»ç‡ˆæ´»å‹• (è«‹æ³¨æ„èˆ‰è¾¦æ—¥æœŸ)", spotName: "åµå±±æ¸¡æœˆæ©‹ã€ç«¹æ—å°å¾‘", isSpot: true },
           { time: "19:30", desc: "æ™šé¤æˆ–å›é£¯åº—ä¼‘æ¯", icon: "ğŸœ", detail: "æ»¾å‹•å¼èª¿æ•´ï¼Œå¯é¸æ“‡è»Šç«™å‘¨é‚Šç¾é£Ÿ" },
       ],
   },
   {
       id: 'day2', day: 2, date: "10/17 (äº”)", title: "å¤éƒ½é¢¨æƒ…ï¼šæ¸…æ°´å¯ºï¼‹å…«å‚ç¥ç¤¾ï¼‹éŒ¦å¸‚å ´", theme: "æ–‡åŒ–ãƒ»ç¾é£Ÿ",
       schedule: [
           { time: "08:30", desc: "å‡ºç™¼ â†’ å¸‚å·´å£«è‡³äº”æ¡å‚", icon: "ğŸšŒ", detail: "æ­ä¹˜å¸‚å€å·´å£«ï¼Œæº–å‚™é–‹å§‹å¤è¹Ÿå·¡ç¦®" },
           { time: "09:30", desc: "æ¸…æ°´å¯ºåƒè§€+æ•£æ­¥ä¸‰å¹´å‚ï¼äºŒå¹´å‚", icon: "ğŸ¯", detail: "é–€ç¥¨Â¥500ï¼Œå¯çœºæœ›äº¬éƒ½å¸‚å€", isSpot: true },
           { time: "11:40", desc: "å…«å‚ç¥ç¤¾ï¼†èŠ±è¦‹å°è·¯èµ°èµ°", icon: "â›©ï¸", detail: "æ™¯é»å…è²»ï¼Œå¯è³¼è²·å¾¡å®ˆ", isSpot: true },
           { time: "13:25", desc: "éŒ¦å¸‚å ´åˆé¤ï¼‹é€›è¡—", icon: "ğŸ›ï¸", detail: "äº¬éƒ½çš„å»šæˆ¿ï¼Œå“åšå„ç¨®åœ¨åœ°å°åƒ" },
           { time: "15:00", desc: "å››æ¡æ²³åŸç”ºè‡ªç”±æ´»å‹• (æˆ–å»å¹³å®‰ç¥å®®æœ¬æ®¿å€åŸŸå…è²»)", icon: "ğŸ™ï¸", detail: "ç™¾è²¨å…¬å¸è³¼ç‰©æˆ–åƒè§€", isSpot: true, spotName: "å¹³å®‰ç¥å®®æœ¬æ®¿å€åŸŸ" },
           { time: "18:30", desc: "å£½å–œç‡’ä¸‰æ¢æ²³åŸç”ºåº—", icon: "ğŸ¥©", detail: "æ™šé¤é è¨‚ï¼Œå¤§å¿«æœµé ¤" },
           { time: "å‚æ™š", desc: "å›é£¯åº—ä¼‘æ¯", icon: "ğŸ›Œ", detail: "" },
       ],
   },
   {
       id: 'day3', day: 3, date: "10/18 (å…­)", title: "ä¼è¦‹ç¨»è·ï¼‹å¤§é˜ªæ‘©å¤©è¼ªï¼‹å…¥ä½", theme: "ç§»å‹•ãƒ»é³¥å±…",
       schedule: [
           { time: "08:30", desc: "å‡ºç™¼ â†’ ä¼è¦‹ç¨»è·å¤§ç¤¾åƒæ‹œï¼ˆåƒæœ¬é³¥å±…ï¼‰", icon: "â›©ï¸", detail: "æ™¯é»å…è²»ï¼Œå»ºè­°ç©¿è‘—èˆ’é©é‹å­", isSpot: true },
           { time: "11:00", desc: "åˆé¤ â†’ å›äº¬éƒ½é£¯åº—å–è¡Œæ", icon: "ğŸ´", detail: "M's Hotel Check-out: 10:00" },
           { time: "14:20", desc: "æ­ JR æ–°å¿«é€Ÿ â†’ å¤§é˜ªæ¢…ç”°", icon: "ğŸš…", detail: "è·¨åŸå¸‚ç§»å‹•ï¼Œè»Šç¨‹ç´„ 30 åˆ†é˜" },
           { time: "15:30", desc: "æŠµé”æ¢…ç”° â†’ HEP FIVE æ‘©å¤©è¼ª", icon: "ğŸ¡", detail: "ğŸš¨ **æ³¨æ„ï¼šè¡Œç¨‹è¨»æ˜ç¶­ä¿®ä¸­**ï¼Œå»ºè­°æ›¿ä»£æ–¹æ¡ˆ", isSpot: true },
           { time: "17:00", desc: "å‰å¾€é£¯åº— â†’ å…¥ä½ The Bridge Hotel Shinsaibashi", icon: "ğŸ¨", detail: "Check-in: 15:00 / é£¯åº—é›»è©±: +81-6-4963-3060" },
           { time: "18:30", desc: "é“é “å €ï¼†å¿ƒé½‹æ©‹è‡ªç”±æ´»å‹•", icon: "ğŸ", detail: "å¤œé–“è³¼ç‰©èˆ‡ç¾é£Ÿï¼Œå¿…æ‹æ ¼åŠ›é«˜æ‹›ç‰Œ", isSpot: true },
       ],
   },
   {
       id: 'day4', day: 4, date: "10/19 (æ—¥)", title: "å¤§é˜ªæ·±åº¦ï¼šå¤§é˜ªåŸï¼‹å¤©æ»¿å®®ï¼‹ä»Šæ˜”é¤¨ï¼‹é»‘é–€å¸‚å ´", theme: "æ­·å²ãƒ»åº¶æ°‘",
       schedule: [
           { time: "08:30", desc: "åœ°éµè‡³å¤§é˜ªå•†å‹™åœ’å€", icon: "ğŸš‡", detail: "é–‹å§‹ä½¿ç”¨å¤§é˜ªå‘¨éŠåˆ¸" },
           { time: "09:00", desc: "åƒè§€å¤§é˜ªåŸï¼†å¾¡åº§èˆ¹ï¼‹åšç‰©é¤¨", icon: "ğŸ¯", detail: "ç´„ 2.5 å°æ™‚ï¼Œå‘¨éŠåˆ¸å¯ç”¨", isSpot: true },
           { time: "12:00", desc: "å¤§é˜ªå¤©æ»¿å®®åƒæ‹œ", icon: "â›©ï¸", detail: "å…è²»åƒè§€ï¼Œç¥ˆæ±‚å­¸æ¥­é †åˆ©", isSpot: true },
           { time: "12:30", desc: "å¤©ç¥æ©‹ç­‹å•†åº—è¡—åˆé¤", icon: "ğŸœ", detail: "æ—¥æœ¬æœ€é•·å•†åº—è¡—ï¼Œé‚Šèµ°é‚Šåƒ" },
           { time: "13:30", desc: "å¤§é˜ªç”Ÿæ´»ä»Šæ˜”é¤¨ï¼ˆç©¿è¶Šæ±Ÿæˆ¶æ™‚ä»£è¡—æ™¯ï¼Œå¯é«”é©—å’Œæœï¼‰", icon: "ğŸ˜ï¸", detail: "å‘¨éŠåˆ¸å¯ç”¨ï¼Œå®¤å…§æ™¯é»", isSpot: true },
           { time: "15:30", desc: "é»‘é–€å¸‚å ´æ•£ç­–ï¼Œåšé®®æµ·é®®/å’Œç‰›ä¸²/æ°´æœå¤§ç¦", icon: "ğŸŸ", detail: "å¤§é˜ªç¾é£Ÿå»šæˆ¿ï¼Œç›¡æƒ…äº«ç”¨", isSpot: true },
           { time: "17:00", desc: "å›å¿ƒé½‹æ©‹ï¼é“é “å €è‡ªç”±é€›è¡—", icon: "ğŸ›ï¸", detail: "è£œè¶³ä¼´æ‰‹ç¦®æˆ–è—¥å¦" },
           { time: "20:00", desc: "ç‡’è‚‰åŠ›ä¸¸é›£æ³¢é“é “å €åº—", icon: "ğŸ¥©", detail: "æ™šé¤é è¨‚ï¼Œäº«å—åƒåˆ°é£½" },
       ],
   },
   {
       id: 'day5', day: 5, date: "10/20 (ä¸€)", title: "å¤§é³¥å¤§ç¤¾åƒæ‹œï¼‹è¿”å°", theme: "è¿”ç¨‹ãƒ»åƒæ‹œ",
       schedule: [
           { time: "08:30", desc: "åœ°éµè‡³å¤©ç‹å¯º â†’ JRè‡³é³³ç«™", icon: "ğŸš‡", detail: "å‰å¾€å¤§é˜ªéƒŠå€é€²è¡Œå‘Šåˆ¥åƒæ‹œ" },
           { time: "09:20", desc: "åƒæ‹œå¤§é³¥å¤§ç¤¾", icon: "â›©ï¸", detail: "å…è²»åƒè§€ï¼Œæ„Ÿè¬æ—…é€”å¹³å®‰", isSpot: true },
           { time: "10:00", desc: "JRï¼å—æµ·é›»éµ â†’ é—œè¥¿æ©Ÿå ´", icon: "ğŸš…", detail: "é ç•™å……è¶³æ™‚é–“å‰å¾€ KIX" },
           { time: "11:00", desc: "å ±åˆ°ï¼é€€ç¨…ï¼åˆé¤æº–å‚™", icon: "ğŸ›„", detail: "Bridge Hotel Check-out: 11:00 / æ©Ÿå ´æ‰‹çºŒåŠæœ€å¾Œçš„è³¼ç‰©æ™‚é–“" },
           { time: "14:00", desc: "æ­æ©Ÿè¿”å°", icon: "ğŸ›¬", detail: "ä¸­è¯èˆªç©º CI0153ï¼ŒæœŸå¾…ä¸‹æ¬¡æ—…ç¨‹ï¼" },
       ],
   }
];

// æ™¯é»è©³ç´°è³‡æ–™åº«
const SPOT_DESCRIPTIONS = {
   "åµå±±æ¸¡æœˆæ©‹ã€ç«¹æ—å°å¾‘": {
       desc: "äº¬éƒ½æœ€å…·ä»£è¡¨æ€§çš„è‡ªç„¶æ™¯è§€ï¼Œåƒå¤©ç«¹æ—ç‡Ÿé€ å‡ºå¹½éœæ°›åœï¼Œç§‹å­£æ¥“è‘‰æ™‚æœ€ç¾ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šJRåµ¯å³¨åµå±±ç«™ (æ­¥è¡Œ10åˆ†)ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼šå…¨æ—¥é–‹æ”¾ (ç«¹æ—)ã€‚\nâ³ å»ºè­°åœç•™ï¼š1.5-2å°æ™‚ã€‚\nâœ¨ ç‰¹è‰²ï¼šå…è²»ã€å¯ç§Ÿå€Ÿå’Œæœæ¼«æ­¥ï¼Œæ™¯è‰²å®œäººã€‚",
       link: "https://maps.google.com/maps?q=%E5%B5%90%E5%B1%B1%E7%AB%B9%E6%9E%97%E5%B0%8F%E5%BE%91+%C2%B7+Kyoto%2C+Kyoto"
   },
   "æ¸…æ°´å¯ºåƒè§€+æ•£æ­¥ä¸‰å¹´å‚ï¼äºŒå¹´å‚": {
       desc: "ä¸–ç•Œéºç”¢ï¼Œä»¥ã€Œæ¸…æ°´ä¹‹èˆå°ã€èåï¼Œå¯é çœºäº¬éƒ½å¸‚å€ã€‚æ˜¯è³¼è²·ä¼´æ‰‹ç¦®çš„å¥½å»è™•ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šå¸‚å·´å£«ã€Œäº”æ¡å‚ã€ç«™ (æ­¥è¡Œ10åˆ†)ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼š06:00 - 18:00ã€‚\nâ³ å»ºè­°åœç•™ï¼š2-3å°æ™‚ (å«äºŒå¹´å‚/ä¸‰å¹´å‚)ã€‚\nğŸ’° é–€ç¥¨ï¼šÂ¥500ã€‚æç¤ºï¼šå»ºè­°æ—©ä¸Šå‰å¾€é¿é–‹äººæ½®ã€‚",
       link: "https://maps.google.com/maps?q=%E6%B8%85%E6%B0%B4%E5%AF%BA+%C2%B7+Kyoto%2C+Kyoto"
   },
   "å…«å‚ç¥ç¤¾ï¼†èŠ±è¦‹å°è·¯èµ°èµ°": {
       desc: "äº¬éƒ½ç¥‡åœ’åœ°å€çš„å®ˆè­·ç¥ï¼Œæ™šä¸Šé»ç‡ˆå¾Œæ°›åœæ¥µä½³ï¼Œæ„Ÿå—å¤éƒ½å¤œè‰²ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šäº¬é˜ªç¥‡åœ’å››æ¡ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼šå…¨æ—¥é–‹æ”¾ã€‚\nâ³ å»ºè­°åœç•™ï¼š1å°æ™‚ã€‚\nâœ¨ ç‰¹è‰²ï¼šå¤œé–“æ™¯è‰²ç¾éº—ï¼ŒèŠ±è¦‹å°è·¯æ˜¯è—å¦“å¯èƒ½å‡ºæ²’çš„åœ°æ–¹ã€‚",
       link: "https://maps.google.com/maps?q=%E5%85%AB%E5%9D%82%E7%A5%9E%E7%A4%BE%E6%9C%AC%E6%AE%BF+%C2%B7+Kyoto%2C+Kyoto"
   },
   "å¹³å®‰ç¥å®®æœ¬æ®¿å€åŸŸ": {
       desc: "å®å‰çš„æœ±ç´…è‰²å»ºç¯‰å’Œæ—¥æœ¬æœ€å¤§çš„é³¥å±…ä¹‹ä¸€ï¼Œå……æ»¿æ­·å²æ„Ÿã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šåœ°éµæ±è¥¿ç·šæ±å±±ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼š06:00 - 17:00 (ä¾å­£ç¯€è®Šå‹•)ã€‚\nâ³ å»ºè­°åœç•™ï¼š1å°æ™‚ã€‚\nğŸ’° è²»ç”¨ï¼šæœ¬æ®¿å…è²»ï¼Œç¥è‹‘ï¼ˆæ—¥å¼åº­åœ’ï¼‰éœ€å¦è³¼ç¥¨ã€‚",
       link: "https://maps.google.com/maps?q=%E5%B9%B3%E5%AE%89%E7%A5%9E%E5%AE%AE+%C2%B7+Kyoto%2C+Kyoto"
   },
   "ä¼è¦‹ç¨»è·å¤§ç¤¾åƒæ‹œï¼ˆåƒæœ¬é³¥å±…ï¼‰": {
       desc: "ä»¥ç¶¿å»¶å±±é ­çš„ã€Œåƒæœ¬é³¥å±…ã€èåï¼Œæ˜¯ç¥ˆæ±‚ç”Ÿæ„èˆˆéš†çš„å…è²»æ™¯é»ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šJRç¨»è·ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼šå…¨æ—¥é–‹æ”¾ã€‚\nâ³ å»ºè­°åœç•™ï¼š1-2å°æ™‚ (èµ°å®Œä¸€åœˆç´„éœ€2å°æ™‚)ã€‚\nâœ¨ ç‰¹è‰²ï¼šå…è²»ã€24å°æ™‚é–‹æ”¾ã€‚æ‹ç…§å»ºè­°æ—©ä¸Šæˆ–å‚æ™šï¼Œå…‰ç·šè¼ƒä½³ã€‚",
       link: "https://maps.google.com/maps?q=%E4%BC%8F%E8%A6%8B%E7%A8%B2%E8%8D%B7%E5%A4%A7%E7%A4%BE+%C2%B7+Kyoto%2C+Kyoto"
   },
   "HEP FIVE æ‘©å¤©è¼ª": {
       desc: "ğŸš¨ ç¶­ä¿®è­¦ç¤ºï¼šæ‚¨çš„è¡Œç¨‹è¨»æ˜æ­¤è™•ç¶­ä¿®ã€‚å»ºè­°æ”¹ç‚ºæ¢…ç”°è—å¤©å¤§å»ˆç©ºä¸­åº­åœ’ç­‰æ›¿ä»£æ™¯é»ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šé˜ªæ€¥æ¢…ç”°ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼šé€šå¸¸ 11:00 - 22:45ã€‚\nâœ¨ æ›¿ä»£å»ºè­°ï¼šæ¢…ç”°è—å¤©å¤§å»ˆç©ºä¸­åº­åœ’ (å‘¨éŠåˆ¸å¯ç”¨)ã€‚",
       link: "" // ä¸æä¾›é€£çµï¼Œå¼·èª¿ç¶­ä¿®
   },
   "é“é “å €ï¼†å¿ƒé½‹æ©‹è‡ªç”±æ´»å‹•": {
       desc: "å¤§é˜ªæœ€ç†±é¬§çš„å€åŸŸä¹‹ä¸€ï¼Œå……æ»¿äº†ç¾é£Ÿã€è³¼ç‰©å’Œå¨›æ¨‚ã€‚å¿…æ‹æ ¼åŠ›é«˜æ‹›ç‰Œã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šåœ°éµå¿ƒé½‹æ©‹ç«™/é›£æ³¢ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼šåº—å®¶å„ç•°ï¼Œå¤šæ•¸è‡³ 22:00ã€‚\nâ³ å»ºè­°åœç•™ï¼š3å°æ™‚ä»¥ä¸Šã€‚\nâœ¨ ç‰¹è‰²ï¼šå¿ƒé½‹æ©‹ PARCOã€è—¥å¦åº—è³¼ç‰©ã€ç¾é£Ÿé›†ä¸­åœ°ã€‚",
       link: "https://maps.google.com/maps?q=%E5%BF%83%E6%96%8E%E6%A9%8BPARCO+%C2%B7+Osaka%2C+Osaka"
   },
   "åƒè§€å¤§é˜ªåŸï¼†å¾¡åº§èˆ¹ï¼‹åšç‰©é¤¨": {
       desc: "æ—¥æœ¬ä¸‰å¤§ååŸä¹‹ä¸€ï¼Œæ˜¯å¤§é˜ªæ­·å²çš„è±¡å¾µã€‚åŒ…å«å¾¡åº§èˆ¹é«”é©—åŠåšç‰©é¤¨åƒè§€ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šJRæ£®ä¹‹å®®ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼š09:00 - 17:00 (å¤©å®ˆé–£)ã€‚\nâ³ å»ºè­°åœç•™ï¼š2.5å°æ™‚ã€‚\nğŸ’° è²»ç”¨ï¼šå¤©å®ˆé–£Â¥600ï¼Œå¾¡åº§èˆ¹Â¥1500 (å‘¨éŠåˆ¸å¯ç”¨)ã€‚",
       link: "https://maps.google.com/maps?q=%E5%A4%A7%E9%98%AA%E5%9F%8E+%C2%B7+Osaka%2C+Osaka"
   },
   "å¤§é˜ªå¤©æ»¿å®®åƒæ‹œ": {
       desc: "ä¸»ç¥€å­¸å•ä¹‹ç¥ï¼Œæ˜¯ç•¶åœ°äººç¥ˆæ±‚å­¸æ¥­å’Œè€ƒè©¦é †åˆ©çš„é‡è¦ç¥ç¤¾ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šJRå¤§é˜ªå¤©æ»¿å®®ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼š09:00 - 17:00ã€‚\nâ³ å»ºè­°åœç•™ï¼š0.5-1å°æ™‚ã€‚\nâœ¨ é„°è¿‘ï¼šå¤©ç¥æ©‹ç­‹å•†åº—è¡—ï¼Œé©åˆé€›è¡—è³¼ç‰©ã€‚",
       link: "https://maps.google.com/maps?q=%E5%A4%A7%E9%98%AA%E5%A4%A9%E6%BB%85%E5%AE%AE+%C2%B7+Osaka%2C+Osaka"
   },
   "å¤§é˜ªç”Ÿæ´»ä»Šæ˜”é¤¨ï¼ˆç©¿è¶Šæ±Ÿæˆ¶æ™‚ä»£è¡—æ™¯ï¼Œå¯é«”é©—å’Œæœï¼‰": {
       desc: "é‡ç¾æ±Ÿæˆ¶æ™‚ä»£è¡—æ™¯ï¼Œå¯ä»˜è²»é«”é©—å’Œæœï¼Œæ˜¯äº†è§£å¤§é˜ªåº¶æ°‘ç”Ÿæ´»çš„ç¨ç‰¹åšç‰©é¤¨ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šåœ°éµå¤©ç¥æ©‹ç­‹å…­ä¸ç›®ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼š10:00 - 17:00 (é€±äºŒä¼‘é¤¨)ã€‚\nâ³ å»ºè­°åœç•™ï¼š1.5å°æ™‚ã€‚\nğŸ’° è²»ç”¨ï¼šÂ¥600 (å‘¨éŠåˆ¸å…è²»)ã€‚ç‰¹è‰²ï¼šå®¤å…§æ™¯é»ï¼Œä¸å—å¤©æ°£å½±éŸ¿ã€‚",
       link: "https://maps.google.com/maps?q=%E5%A4%A7%E9%98%AA%E7%94%9F%E6%B4%BB%E4%BB%8A%E6%98%94%E9%A4%A8+%C2%B7+Osaka%2C+Osaka"
   },
   "é»‘é–€å¸‚å ´æ•£ç­–ï¼Œåšé®®æµ·é®®/å’Œç‰›ä¸²/æ°´æœå¤§ç¦": {
       desc: "æœ‰ã€Œå¤§é˜ªå»šæˆ¿ã€ä¹‹ç¨±ï¼Œæ˜¯å“åšç¾åšæ–°é®®æµ·é®®ã€å’Œç‰›ä¸²å’Œå­£ç¯€æ°´æœçš„å¤©å ‚ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šåœ°éµæ—¥æœ¬æ©‹ç«™ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼šå¤šæ•¸åº—å®¶ 09:00 - 18:00ã€‚\nâ³ å»ºè­°åœç•™ï¼š1.5-2å°æ™‚ã€‚\nâœ¨ æç¤ºï¼šå»ºè­°åˆé¤æ™‚æ®µå‰å¾€ï¼Œåº—å®¶è¼ƒé½Šå…¨ã€‚",
       link: "https://maps.google.com/maps?q=%E9%BB%91%E9%96%80%E5%B8%82%E5%A0%B4+%C2%B7+Osaka%2C+Osaka"
   },
   "åƒæ‹œå¤§é³¥å¤§ç¤¾": {
       desc: "ä½æ–¼å¤§é˜ªåºœå ºå¸‚ï¼Œä¾›å¥‰æ—¥æœ¬æ­¦å°Šã€‚æ˜¯å‘Šåˆ¥ä¹‹æ—…çš„æœ€å¾Œä¸€ç«™ï¼Œç¥ˆæ±‚æ—…é€”å¹³å®‰ã€‚",
       details: "ğŸ“ æœ€è¿‘è»Šç«™ï¼šJRé˜ªå’Œç·šè‡³é³³ç«™ï¼Œè½‰ä¹˜å—æµ·å·´å£«ã€‚\nâ° ç‡Ÿæ¥­æ™‚é–“ï¼š09:00 - 17:00ã€‚\nâ³ å»ºè­°åœç•™ï¼š1å°æ™‚ã€‚\nâœ¨ ç‰¹è‰²ï¼šç’°å¢ƒæ¸…å¹½ï¼Œé©åˆæ—…é€”çµæŸå‰æ²‰æ¾±å¿ƒæƒ…ã€‚",
       link: "https://maps.google.com/maps?q=%E5%A4%A7%E9%B3%A5%E5%A4%A7%E7%A4%BE+%C2%B7+Sakai%2C+Osaka"
   }
};

@Component({
 selector: 'app-root',
 // ä½¿ç”¨ Tailwind CSS é€²è¡Œå°ˆæ¥­ä¸”éŸ¿æ‡‰å¼çš„ä½ˆå±€
 template: `
   <div class="min-h-screen bg-gray-50 flex flex-col items-center">
     <!-- é ‚éƒ¨æ¨™é¡Œåˆ— -->
     <header class="w-full bg-white border-b-4 border-blue-600 shadow-md p-6 sticky top-0 z-10">
         <h1 class="text-3xl font-black text-blue-800 flex items-center">
             <span class="mr-3 text-4xl">âœˆï¸</span> é—œè¥¿äº”æ—¥ãƒ»å°ˆæ¥­è¡Œç¨‹è¡¨
         </h1>
         <p class="text-sm text-gray-500 mt-1">æ—¥æœŸï¼š10/16 ~ 10/20 (5å¤©4å¤œ) | 4äººå®¶æ—æ—…è¡Œ</p>
     </header>
     
     <!-- ä¸»å…§å®¹å€å¡Š - å´é‚Šæ¬„èˆ‡è¡Œç¨‹åˆ—è¡¨ -->
     <div class="w-full max-w-7xl flex flex-col lg:flex-row p-4 lg:space-x-6">
       
       <!-- å´é‚Šæ¬„ï¼šè¡Œå‰å¿…å‚™è³‡è¨Š (åœ¨å°è¢å¹•ä¸Šåœ¨æœ€ä¸Šæ–¹ï¼Œå¤§è¢å¹•ä¸Šå›ºå®šå·¦å´) -->
       <div class="lg:w-1/3 w-full mb-6 lg:mb-0 lg:sticky lg:top-[110px] lg:h-fit">
           <div class="bg-white p-6 rounded-xl shadow-xl border-t-4 border-amber-500">
               <h2 class="text-xl font-extrabold text-amber-600 mb-4 flex items-center">
                   <span class="text-2xl mr-2">ğŸŒŸ</span> è¡Œå‰å¿…å‚™èˆ‡æ•‘å‘½è³‡è¨Š
               </h2>
               <div class="space-y-3 text-sm text-gray-700">
                   <p><span class="font-bold text-blue-600">ğŸ’´ åƒè€ƒåŒ¯ç‡ï¼š</span> 1 TWD â‰ˆ 4.8 JPY</p>
                   <p><span class="font-bold text-blue-600">ğŸ“¶ ç¶²è·¯ç‹€æ…‹ï¼š</span> <span class="text-green-600 font-bold">å·²ç¢ºèªä¸é™å®¹é‡é«˜é€Ÿç¶²å¡ï¼</span></p>

                   <div class="pt-2 border-t border-gray-100">
                       <p class="font-bold text-red-600 mb-1">ğŸ“ ç·Šæ€¥è¯çµ¡</p>
                       <ul class="ml-4 list-disc text-gray-500">
                           <li>æ—¥æœ¬æ€¥æ•‘/æ¶ˆé˜²ï¼š<span class="font-bold">119</span></li>
                           <li>æ—¥æœ¬å ±è­¦ï¼š<span class="font-bold">110</span></li>
                           <li>è¾¦äº‹è™•ï¼š+81-6-6612-8750</li>
                       </ul>
                   </div>

                   <div class="pt-2 border-t border-gray-100">
                       <p class="font-bold text-blue-600 mb-1">ğŸ¨ ä½å®¿è©³ç´°è³‡è¨Š</p>
                       <p class="font-semibold text-gray-800 mt-2">ğŸ“ äº¬éƒ½ï¼šM's Hotel (10/16 - 10/18)</p>
                       <ul class="ml-4 list-disc text-gray-500 space-y-0.5 text-xs">
                           <li>åœ°å€ï¼šäº¬éƒ½å¸‚å—å€æ±ä¹æ¡æ±å±±ç‹ç”º19</li>
                           <li>é›»è©±ï¼š+81-75-661-8000</li>
                           <li>Check-in: 15:00 / Check-out: 10:00</li>
                       </ul>
                       <p class="font-semibold text-gray-800 mt-2">ğŸ“ å¤§é˜ªï¼šBridge Hotel (10/18 - 10/20)</p>
                        <ul class="ml-4 list-disc text-gray-500 space-y-0.5 text-xs">
                           <li>åœ°å€ï¼šå¤§é˜ªå¸‚ä¸­å¤®å€æ±å¿ƒé½‹æ©‹1ä¸ç›®11-19</li>
                           <li>é›»è©±ï¼š+81-6-4963-3060</li>
                           <li>Check-in: 15:00 / Check-out: 11:00</li>
                       </ul>
                   </div>
               </div>
           </div>
       </div>

       <!-- ä¸»è¡Œç¨‹å…§å®¹ï¼šå‚ç›´æ»¾å‹•åˆ—è¡¨ -->
       <div class="lg:w-2/3 w-full space-y-8">
           <h2 class="text-2xl font-bold text-gray-800 mb-2 border-b-2 pb-2">ğŸ—“ï¸ è©³ç´°æ¯æ—¥è¡Œç¨‹</h2>

           <!-- Angular For Loop æ¸²æŸ“æ¯æ—¥å¡ç‰‡ -->
           @for (dayData of itineraryData; track dayData.id) {
             <div class="bg-white p-6 rounded-xl shadow-2xl border-l-4 border-blue-500 hover:shadow-3xl transition-shadow duration-300">
                 <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 pb-3 border-b border-gray-100">
                     <div class="flex items-center">
                         <span class="text-3xl font-extrabold text-blue-600 mr-3">Day {{ dayData.day }}</span>
                         <div>
                             <h3 class="text-xl font-bold text-gray-800">{{ dayData.title }}</h3>
                             <span class="text-sm text-gray-500">{{ dayData.date }} | ä¸»é¡Œï¼š{{ dayData.theme }}</span>
                         </div>
                     </div>
                     <button (click)="scrollToDay(dayData.id)" class="hidden sm:block text-sm text-blue-500 font-medium hover:text-blue-700 transition">
                        è·³è‡³é ‚ç«¯
                     </button>
                 </div>
                 
                 <!-- å–®æ—¥è¡Œç¨‹æ™‚é–“è»¸ -->
                 <div class="relative pt-2">
                   <!-- æ™‚é–“è»¸ç·š -->
                   <div class="absolute top-0 bottom-0 left-2 w-0.5 bg-blue-100"></div>

                   <!-- Angular For Loop æ¸²æŸ“æ¯å€‹è¡Œç¨‹é …ç›® -->
                   @for (item of dayData.schedule; track $index) {
                     <div class="mb-5 flex items-start pl-8 relative">
                         <!-- æ™‚é–“é»åœ–æ¨™ -->
                         <div class="absolute left-2 top-0.5 transform -translate-x-1/2">
                             <div [class]="getTimelineIconClass(item.isSpot, item.detail)">{{ item.icon }}</div>
                         </div>

                         <div class="flex-shrink-0 w-16 text-sm font-semibold text-gray-500 pt-1">
                             {{ item.time }}
                         </div>

                         <div class="flex-1 ml-3 pt-1">
                             <!-- æè¿°/æ™¯é»åç¨± -->
                             @if (item.isSpot) {
                               <p (click)="openSpotModal(item.spotName || item.desc)"
                                   class="font-bold text-blue-700 cursor-pointer hover:underline hover:text-blue-900 transition-colors duration-150"
                                   [class]="{'!text-red-600': item.detail.includes('ç¶­ä¿®ä¸­')}"
                               >
                                   {{ item.desc }}
                               </p>
                             } @else {
                               <p class="font-medium text-gray-800">{{ item.desc }}</p>
                             }
                             <!-- è©³ç´°èªªæ˜ -->
                             <p class="text-xs mt-0.5 text-gray-500"
                                 [class]="{'!text-red-500 font-medium': item.detail.includes('ç¶­ä¿®ä¸­')}"
                             >
                                 {{ item.detail }}
                             </p>
                         </div>
                     </div>
                   }
                 </div>
             </div>
           }

           <div class="text-center text-gray-500 py-8">--- è¡Œç¨‹çµæŸï¼Œç¥æ—…é€”åœ“æ»¿ï¼ ---</div>
       </div>
     </div>
   </div>
   
   <!-- æ™¯é»è©³æƒ…å½ˆçª— (Modal) -->
   @if (selectedSpot()) {
       <div class="fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4" (click)="closeSpotModal()">
           <div
               class="bg-white rounded-xl p-6 w-full max-w-md shadow-2xl transform transition-transform duration-300 scale-100"
               (click)="$event.stopPropagation()"
           >
               <h3 class="text-2xl font-extrabold text-blue-700 mb-3 border-b border-gray-200 pb-2">
                   {{ spotDetail()?.displayTitle }}
               </h3>
               
               <p class="text-gray-600 mb-4 text-base italic">{{ spotDetail()?.desc }}</p>
               
               <div class="text-sm space-y-3 mb-6 p-4 rounded-xl bg-blue-50 border border-blue-200">
                   <!-- æ ¼å¼åŒ–å¾Œçš„è©³ç´°è³‡è¨Š -->
                   @for (line of spotDetail()?.formattedDetails; track $index) {
                       <p class="flex items-start text-gray-700 leading-relaxed">{{ line }}</p>
                   }
               </div>

               @if (spotDetail()?.link) {
                   <a
                       [href]="spotDetail()?.link"
                       target="_blank"
                       class="block w-full text-center py-3 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 transition shadow-lg"
                   >
                       é–‹å•Ÿ Google åœ°åœ–å°èˆª ğŸ—ºï¸
                   </a>
               } @else {
                   <div class="text-center text-red-500 font-medium py-3 border border-red-200 rounded-xl bg-red-50">
                       ğŸš¨ ç„¡åœ°åœ–é€£çµæˆ–åœ°é»ç¶­ä¿®ä¸­
                   </div>
               }
               
               <button (click)="closeSpotModal()" class="w-full mt-4 text-sm text-gray-500 py-1 hover:text-blue-600 transition">
                   é—œé–‰è¦–çª—
               </button>
           </div>
       </div>
   }
 `,
 styles: [
   `
     /* ç¢ºä¿ä¸»å…§å®¹å€åœ¨å¯¬è¢å¹•ä¸Šèƒ½æ­£ç¢ºä½ˆå±€ */
     @media (min-width: 1024px) {
       /* Lg breakpoint */
       .lg\\:sticky {
         position: sticky;
         top: 100px; /* è€ƒæ…®åˆ° header çš„é«˜åº¦ */
       }
     }
     /* è‡ªå®šç¾©åœ“å½¢åœ–æ¨™æ¨£å¼ */
     .timeline-icon {
       width: 32px;
       height: 32px;
       display: flex;
       align-items: center;
       justify-content: center;
       border-radius: 9999px;
       font-weight: 700;
       font-size: 16px;
       box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
       transition: all 0.2s ease-in-out;
     }
     .bg-red {
        background-color: #ef4444; /* red-500 */
        color: white;
     }
     .bg-blue {
        background-color: #3b82f6; /* blue-500 */
        color: white;
     }
     .bg-gray {
        background-color: #d1d5db; /* gray-300 */
        color: #1f2937; /* gray-800 */
     }
     /* æ™¯é»å°ˆç”¨å‹•ç•«æ•ˆæœ */
     .spot-icon-hover:hover {
       transform: scale(1.1);
       box-shadow: 0 4px 10px rgba(59, 130, 246, 0.5); /* blue-500 shadow */
     }
   `
 ],
 changeDetection: ChangeDetectionStrategy.OnPush,
})
export class App {
   // ä½¿ç”¨ Signals å„²å­˜è¡Œç¨‹è³‡æ–™
   itineraryData = signal(ITINERARY_DATA);
   
   // ä½¿ç”¨ Signals å„²å­˜ç•¶å‰é¸ä¸­çš„æ™¯é»åç¨± (ç”¨æ–¼ Modal)
   selectedSpot = signal<string | null>(null);

   /**
    * è¨ˆç®—å±¬æ€§ï¼šæ ¹æ“š selectedSpot çš„å€¼ï¼Œå‹•æ…‹è¨ˆç®—æ™¯é»çš„è©³ç´°è³‡è¨Š
    */
   spotDetail = computed(() => {
       const spotName = this.selectedSpot();
       if (!spotName) return null;

       const spotData = SPOT_DESCRIPTIONS[spotName] || {
           desc: "æ­¤é …ç›®ç‚ºè¡Œç¨‹å®‰æ’ï¼Œç„¡è©³ç´°æ™¯é»ä»‹ç´¹ã€‚",
           details: "",
           link: ""
       };

       const displayTitle = spotName.split('ï¼ˆ')[0].split('+')[0].trim();
       
       // æ ¼å¼åŒ–ç´°ç¯€æ–‡å­—ï¼ŒåŠ å…¥è¡¨æƒ…ç¬¦è™Ÿ
       const formattedDetails = spotData.details.split('\n').map(line => {
           if (line.includes('ğŸ“')) return `<span class="font-bold text-blue-600 mr-2">ğŸ“ åœ°å€/è»Šç«™ï¼š</span>${line.substring(line.indexOf('ğŸ“') + 1).trim()}`;
           if (line.includes('â°')) return `<span class="font-bold text-blue-600 mr-2">â° é–‹æ”¾æ™‚é–“ï¼š</span>${line.substring(line.indexOf('â°') + 1).trim()}`;
           if (line.includes('â³')) return `<span class="font-bold text-blue-600 mr-2">â³ å»ºè­°åœç•™ï¼š</span>${line.substring(line.indexOf('â³') + 1).trim()}`;
           if (line.includes('ğŸ’°')) return `<span class="font-bold text-blue-600 mr-2">ğŸ’° é–€ç¥¨è²»ç”¨ï¼š</span>${line.substring(line.indexOf('ğŸ’°') + 1).trim()}`;
           if (line.includes('âœ¨')) return `<span class="font-bold text-blue-600 mr-2">âœ¨ ç‰¹åˆ¥æç¤ºï¼š</span>${line.substring(line.indexOf('âœ¨') + 1).trim()}`;
           return line;
       });

       return { ...spotData, displayTitle, formattedDetails };
   });

   /**
    * ç²å–æ™‚é–“è»¸åœ–æ¨™çš„ CSS Class
    * @param isSpot æ˜¯å¦ç‚ºæ™¯é»
    * @param detail è¡Œç¨‹ç´°ç¯€
    * @returns çµ„åˆçš„ Tailwind CSS Class
    */
   getTimelineIconClass(isSpot: boolean | undefined, detail: string): string {
     let baseClass = 'timeline-icon';
     if (detail.includes('ç¶­ä¿®ä¸­')) {
       return `${baseClass} bg-red`; // ç¶­ä¿®ä½¿ç”¨ç´…è‰²
     }
     if (isSpot) {
       return `${baseClass} bg-blue spot-icon-hover`; // æ™¯é»ä½¿ç”¨è—è‰²
     }
     return `${baseClass} bg-gray`; // ä¸€èˆ¬è¡Œç¨‹ä½¿ç”¨ç°è‰²
   }

   /**
    * æ‰“é–‹æ™¯é»è©³æƒ…å½ˆçª—
    * @param spotName æ™¯é»åç¨±
    */
   openSpotModal(spotName: string): void {
     this.selectedSpot.set(spotName);
   }

   /**
    * é—œé–‰æ™¯é»è©³æƒ…å½ˆçª—
    */
   closeSpotModal(): void {
     this.selectedSpot.set(null);
   }
   
   /**
    * æ»¾å‹•åˆ°ç‰¹å®šæ—¥æœŸçš„å¡ç‰‡é ‚ç«¯
    * @param dayId æ—¥æœŸ ID (e.g., 'day1')
    */
   scrollToDay(dayId: string): void {
     const element = document.getElementById(dayId);
     if (element) {
       // ä½¿ç”¨ smooth æ»¾å‹•åˆ°é ‚éƒ¨ï¼Œä¸¦ç•™å‡º header çš„ç©ºé–“
       window.scrollTo({
         top: element.offsetTop - 100,
         behavior: 'smooth'
       });
     }
   }
}